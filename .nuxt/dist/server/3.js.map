{"version":3,"file":"3.js","sources":["webpack:///./apis/article.js","webpack:///./apis/profile.js","webpack:///./pages/article/index.vue?cd30","webpack:///./pages/article/index.vue","webpack:///./pages/article/index.vue?01c6","webpack:///./pages/article/index.vue?e35a"],"sourcesContent":["import { fetch } from '../plugins/http'\r\n\r\n/**\r\n * 获取所有文章标签\r\n * @returns\r\n */\r\nexport const getTags = () => {\r\n  return fetch.get('/api/tags')\r\n}\r\n\r\n/**\r\n * 发布一篇新的文章\r\n * @typedef { Article } article\r\n * @property { String } body 内容\r\n * @property { String } title 标题\r\n * @property { String } description 描述内容\r\n * @property { Array } tagList 标签列表\r\n * @returns\r\n */\r\nexport const newArticle = article => {\r\n  return fetch.post('api/articles', {\r\n    article\r\n  })\r\n}\r\n\r\n/**\r\n * 获取所有的文章列表\r\n * @typedef { ArticleList } params\r\n * @property { Number } limit 步长\r\n * @property { Number } offset 每页多少条\r\n * @returns\r\n */\r\nexport const getGlobalFeedArticle = params => {\r\n  return fetch.get(`api/articles?limit=${params.limit}&offset=${params.offset}`)\r\n}\r\n\r\n/**\r\n * 获取你发表的文章列表\r\n * @typedef { ArticleList } params\r\n * @property { Number } limit 步长\r\n * @property { Number } offset 每页多少条\r\n * @returns\r\n */\r\nexport const getYourFeedArticle = params => {\r\n  return fetch.get(`/api/articles/feed?limit=${params.limit}&offset=${params.offset}`)\r\n}\r\n\r\n/**\r\n * 获取标签文章列表\r\n * @typedef { ArticleList } params\r\n * @property { Number } limit 步长\r\n * @property { Number } offset 每页多少条\r\n * @property { String } tag 当前选中的标签\r\n * @returns\r\n */\r\nexport const getTagArticle = params => {\r\n  return fetch.get(`api/articles?limit=${params.limit}&offset=${params.offset}&tag=${params.tag}`)\r\n}\r\n\r\n/**\r\n * 点赞当前文章\r\n * @param { String } articleSlug 文章的slug\r\n * @returns\r\n */\r\nexport const favoriteArticle = articleSlug => {\r\n  return fetch.post(`/api/articles/${articleSlug}/favorite`)\r\n}\r\n\r\n/**\r\n * 取消点赞当前文章\r\n * @param { String } articleSlug 文章的slug\r\n * @returns\r\n */\r\nexport const cancelFavoriteArticle = articleSlug => {\r\n  return fetch.delete(`/api/articles/${articleSlug}/favorite`)\r\n}\r\n\r\n/**\r\n * 获取文章详情\r\n * @param { String } articleSlug 文章的slug\r\n * @returns\r\n */\r\nexport const getArticleDetail = articleSlug => {\r\n  return fetch.get(`/api/articles/${articleSlug}`)\r\n}\r\n\r\n/**\r\n * 获取文章的评论列表\r\n * @param { String } articleSlug 文章的slug\r\n * @returns\r\n */\r\nexport const getCommentList = articleSlug => {\r\n  return fetch.get(`/api/articles/${articleSlug}/comments`)\r\n}\r\n\r\nexport const postComment = articleSlug => {}\r\n","import { fetch } from '../plugins/http'\r\n\r\n/**\r\n * 获取用户信息\r\n * @param { String } username 用户名称\r\n */\r\nexport const getProfileUserInfo = username => {\r\n  return fetch.get(`/api/profiles/${username}`)\r\n}\r\n\r\n/**\r\n * 关注该用户\r\n * @param { String } username 用户名称\r\n */\r\nexport const followProfile = username => {\r\n  return fetch.post(`api/profiles/${username}/follow`)\r\n}\r\n\r\n/**\r\n * 取消关注该用户\r\n * @param { String } username 用户名称\r\n */\r\nexport const cancelFollowProfile = username => {\r\n  return fetch.delete(`api/profiles/${username}/follow`)\r\n}\r\n\r\n/**\r\n * 获取我的文章列表\r\n * @typedef { ParamsType } params\r\n * @property { String } authorName 作者名称\r\n * @property { Number } pageSize 步长\r\n * @property { Number } offset 偏移量\r\n * @returns\r\n */\r\nexport const getMyArticles = params => {\r\n  return fetch.get(\r\n    `api/articles?author=${params.authorName}&limit=${params.pageSize}&offset=${params.offset}`\r\n  )\r\n}\r\n\r\n/**\r\n * 获取我喜欢的文章列表\r\n * @typedef { ParamsType } params\r\n * @property { String } username 作者名称\r\n * @property { Number } pageSize 步长\r\n * @property { Number } offset 偏移量\r\n * @returns\r\n */\r\nexport const getMyFavoArticles = params => {\r\n  return fetch.get(\r\n    `api/articles?favorited=${params.username}&limit=${params.pageSize}&offset=${params.offset}`\r\n  )\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"article-page\"},[_vm._ssrNode(\"<div class=\\\"banner\\\"><div class=\\\"container\\\"><h1>\"+_vm._ssrEscape(_vm._s(_vm.articleDetail.title))+\"</h1> <div class=\\\"article-meta\\\">\"+((_vm.articleDetail.author)?(\"<div style=\\\"display: inline-block;\\\"><span><img\"+(_vm._ssrAttr(\"src\",_vm.articleDetail.author.image))+\"></span> <div class=\\\"info\\\"><span class=\\\"author\\\">\"+_vm._ssrEscape(_vm._s(_vm.articleDetail.author.username))+\"</span> <span class=\\\"date\\\">\"+_vm._ssrEscape(_vm._s(_vm._f(\"date\")(_vm.articleDetail.updateAt,'MMM DD,YYYY')))+\"</span></div></div>\"):\"<!---->\")+\" <button class=\\\"btn btn-sm btn-outline-secondary\\\"><i class=\\\"ion-plus-round\\\"></i>\"+_vm._ssrEscape(\"\\n           \\n          \"+_vm._s(_vm.articleDetail.author && _vm.articleDetail.author.following ? 'UnFollow' : 'Follow')+\"\\n          \"+_vm._s(_vm.articleDetail.author ? _vm.articleDetail.author.username : '')+\"\\n        \")+\"</button>\\n          \\n        <button class=\\\"btn btn-sm btn-outline-primary\\\"><i class=\\\"ion-heart\\\"></i>\\n            Favorite Post <span class=\\\"counter\\\">\"+_vm._ssrEscape(\"(\"+_vm._s(_vm.articleDetail.favoritesCount)+\")\")+\"</span></button></div></div></div> <div class=\\\"container page\\\"><div class=\\\"row article-content\\\"><div class=\\\"col-md-12\\\"><p>\"+_vm._ssrEscape(\"\\n          \"+_vm._s(_vm.articleDetail.body)+\"\\n        \")+\"</p> <p>\"+_vm._ssrEscape(_vm._s(_vm.articleDetail.description))+\"</p></div></div> <ul class=\\\"tag-list\\\">\"+(_vm._ssrList((_vm.articleDetail.tagList),function(tag,index){return (\"<li class=\\\"tag-default tag-pill tag-outline\\\">\"+_vm._ssrEscape(\"\\n        \"+_vm._s(tag)+\"\\n      \")+\"</li>\")}))+\"</ul> <hr> <div class=\\\"article-actions\\\"><div class=\\\"article-meta\\\">\"+((_vm.articleDetail.author)?(\"<div style=\\\"display: inline-block;\\\"><span><img\"+(_vm._ssrAttr(\"src\",_vm.articleDetail.author.image))+\"></span> <div class=\\\"info\\\"><span class=\\\"author\\\">\"+_vm._ssrEscape(_vm._s(_vm.articleDetail.author.username))+\"</span> <span class=\\\"date\\\">\"+_vm._ssrEscape(_vm._s(_vm._f(\"date\")(_vm.articleDetail.updateAt,'MMM DD, YYYY')))+\"</span></div></div>\"):\"<!---->\")+\" <button class=\\\"btn btn-sm btn-outline-secondary\\\"><i class=\\\"ion-plus-round\\\"></i>\"+_vm._ssrEscape(\"\\n           \\n          \"+_vm._s(_vm.articleDetail.author && _vm.articleDetail.author.following ? 'UnFollow' : 'Follow')+\"\\n          \"+_vm._s(_vm.articleDetail.author ? _vm.articleDetail.author.username : '')+\"\\n        \")+\"</button>\\n         \\n        <button class=\\\"btn btn-sm btn-outline-primary\\\"><i class=\\\"ion-heart\\\"></i>\\n            Favorite Post <span class=\\\"counter\\\">\"+_vm._ssrEscape(\"(\"+_vm._s(_vm.articleDetail.favoritesCount)+\")\")+\"</span></button></div></div> <div class=\\\"row\\\"><div class=\\\"col-xs-12 col-md-8 offset-md-2\\\"><form class=\\\"card comment-form\\\"><div class=\\\"card-block\\\"><textarea placeholder=\\\"Write a comment...\\\" rows=\\\"3\\\" class=\\\"form-control\\\"></textarea></div> <div class=\\\"card-footer\\\"><img\"+(_vm._ssrAttr(\"src\",_vm.user.image))+\" class=\\\"comment-author-img\\\"> <button class=\\\"btn btn-sm btn-primary\\\">\\n              Post Comment\\n            </button></div></form> \"+(_vm._ssrList((_vm.commentList),function(comment){return (\"<div class=\\\"card\\\"><div class=\\\"card-block\\\"><p class=\\\"card-text\\\">\"+_vm._ssrEscape(\"\\n              \"+_vm._s(comment.body)+\"\\n            \")+\"</p></div> <div class=\\\"card-footer\\\">\"+((comment.author)?(\"<a href class=\\\"comment-author\\\"><img\"+(_vm._ssrAttr(\"src\",comment.author.image))+\" class=\\\"comment-author-img\\\"></a>\"):\"<!---->\")+\"\\n             \\n            \"+((comment.author)?(\"<a href class=\\\"comment-author\\\">\"+_vm._ssrEscape(_vm._s(comment.author.username))+\"</a>\"):\"<!---->\")+\" <span class=\\\"date-posted\\\">\"+_vm._ssrEscape(_vm._s(_vm._f(\"date\")(comment.updateAt,'MMM DD, YYYY')))+\"</span></div></div>\")}))+\"</div></div></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {\r\n  getArticleDetail,\r\n  getCommentList,\r\n  favoriteArticle,\r\n  cancelFavoriteArticle\r\n} from '../../apis/article'\r\nimport { followProfile, cancelFollowProfile } from '../../apis/profile'\r\nimport { mapState } from 'vuex'\r\nexport default {\r\n  name: 'Article',\r\n  data() {\r\n    return {\r\n      slug: '',\r\n      articleDetail: {},\r\n      commentList: {}\r\n    }\r\n  },\r\n  async created() {\r\n    this.slug = this.$route.query.slug\r\n    await this.getArticleDetail()\r\n    await this.getArticleCommentList()\r\n    this.$set(this.articleDetail, 'disabledFollow', false)\r\n    this.$set(this.articleDetail, 'disabledFavo', false)\r\n  },\r\n  computed: {\r\n    ...mapState(['user'])\r\n  },\r\n  methods: {\r\n    async getArticleDetail() {\r\n      try {\r\n        const res = await getArticleDetail(this.slug)\r\n        this.articleDetail = res.article\r\n        console.log(this.articleDetail)\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n\r\n    async getArticleCommentList() {\r\n      try {\r\n        const res = await getCommentList(this.slug)\r\n        this.commentList = res.comments\r\n        console.log(this.commentList)\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n\r\n    jumpToProfile() {\r\n      this.$router.push({\r\n        path: '/profile',\r\n        query: {\r\n          username: this.articleDetail.author.username\r\n        }\r\n      })\r\n    },\r\n\r\n    async followOrCancelFollowCurAuthor() {\r\n      if (this.articleDetail.disabledFollow) {\r\n        return\r\n      }\r\n      this.articleDetail.disabledFollow = true\r\n      try {\r\n        if (this.articleDetail.author.following) {\r\n          await cancelFollowProfile(this.articleDetail.author.username)\r\n          this.articleDetail.author.following = false\r\n        } else {\r\n          await followProfile(this.articleDetail.author.username)\r\n          this.articleDetail.author.following = true\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n      this.articleDetail.disabledFollow = false\r\n    },\r\n\r\n    async favoOrCancelFavoCurArticle() {\r\n      if (this.articleDetail.disabledFavo) {\r\n        return\r\n      }\r\n      this.articleDetail.disabledFavo = true\r\n      try {\r\n        if (this.articleDetail.favorited) {\r\n          await cancelFavoriteArticle(this.articleDetail.slug)\r\n          this.articleDetail.favorited = false\r\n          this.articleDetail.favoritesCount -= 1\r\n        } else {\r\n          await favoriteArticle(this.articleDetail.slug)\r\n          this.articleDetail.favorited = true\r\n          this.articleDetail.favoritesCount += 1\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n      this.articleDetail.disabledFavo = false\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3616548f&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"3a64ffb8\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;;;;;;;;AC/FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;;;;;;;;;;;;ACpDA;AACA;AACA;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAMA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAFA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AArEA;AAnBA;;ACvHA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}